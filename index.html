<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to FocusPath</title>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0d78f2" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <style>
    body {
      font-family: 'Lexend', sans-serif;
      background: linear-gradient(120deg, #e0e7ff 0%, #f0f2f5 100%);
      min-height: 100vh;
      overflow-x: hidden;
      transition: background 0.5s;
    }
    .welcome-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; position: relative; }
  .welcome-card { background: rgba(255,255,255,0.95); border-radius: 2.25rem; box-shadow: 0 12px 36px rgba(13,120,242,0.14), 0 4px 14px rgba(13,120,242,0.08); padding: 3rem 2rem; max-width: 540px; text-align: center; z-index: 2; animation: fadeInUp 1.2s cubic-bezier(.23,1.01,.32,1) both; }
    .welcome-title { font-size: 2.8rem; font-weight: 800; color: #0d78f2; margin-bottom: 0.5rem; letter-spacing: -1px; }
    .welcome-desc { font-size: 1.25rem; color: #60748a; margin-bottom: 2rem; }
  .welcome-btn { background: linear-gradient(90deg,#0d78f2 60%,#4f8cff 100%); color: #fff; font-weight: 800; border-radius: 999px; padding: 1rem 2.75rem; font-size: 1.15rem; box-shadow: 0 10px 24px rgba(13,120,242,0.18), 0 2px 8px rgba(13,120,242,0.10); transition: background 0.2s, transform 0.2s; text-decoration: none; display: inline-block; animation: fadeIn 2.2s 1.2s both; letter-spacing:.2px; }
  .welcome-btn:hover { background: linear-gradient(90deg,#095bb5 60%,#0d78f2 100%); transform: translateY(-1px) scale(1.035); }
    .footer { font-size: 12px; color: #60748a; text-align: center; position: fixed; left: 0; right: 0; bottom: 0; z-index: 9999; background: rgba(240,242,245,0.95); pointer-events: none; box-shadow: 0 -2px 8px rgba(0,0,0,0.04); }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(60px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .bubble { position: absolute; border-radius: 50%; opacity: 0.14; pointer-events: none; animation: bubbleFloat 13s infinite ease-in-out; filter: blur(0.2px); }
  @keyframes bubbleFloat { 0% { transform: translateY(0) scale(1); opacity: 0.14; } 50% { transform: translateY(-70px) scale(1.08); opacity: 0.26; } 100% { transform: translateY(0) scale(1); opacity: 0.14; } }
    body[data-theme="dark"] {
      background: linear-gradient(120deg, #1e293b 0%, #334155 100%);
    }
    body[data-theme="dark"] .welcome-card {
      background: rgba(30,41,59,0.98);
      color: #e0e7ff;
      box-shadow: 0 8px 32px rgba(13,120,242,0.18);
    }
    body[data-theme="dark"] .welcome-title {
      color: #60a5fa;
    }
    body[data-theme="dark"] .welcome-desc {
      color: #a5b4fc;
    }
    body[data-theme="dark"] .footer {
      background: rgba(30,41,59,0.95);
      color: #a5b4fc;
    }
    /* Modal Background */
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0; top: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.5);
      align-items: center; justify-content: center;
    }
    .modal-content {
      background: #fff;
      color: #111418;
      padding: 2.5rem 2rem;
      border-radius: 1.5rem;
      width: 400px;
      box-shadow: 0 8px 32px rgba(13,120,242,0.18);
      position: relative;
      text-align: center;
      animation: fadeInUp 0.7s cubic-bezier(.23,1.01,.32,1) both;
      transition: background 0.4s, color 0.4s;
    }
    body[data-theme="dark"] .modal-content {
      background: #1e293b;
      color: #e0e7ff;
    }
    .modal-content input {
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      font-size: 1rem;
      background: #f0f2f5;
      color: #111418;
      transition: background 0.3s, color 0.3s;
    }
    body[data-theme="dark"] .modal-content input {
      background: #334155;
      color: #e0e7ff;
      border: 1px solid #4f8cff;
    }
    .modal-content input:focus {
      outline: 2px solid #0d78f2;
      background: #e6f2ff;
    }
    body[data-theme="dark"] .modal-content input:focus {
      outline: 2px solid #4f8cff;
      background: #1e293b;
    }
    .modal-content button {
      background: linear-gradient(90deg,#0d78f2 60%,#4f8cff 100%);
      color: #fff;
      font-weight: 700;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      box-shadow: 0 2px 12px rgba(13,120,242,0.10);
      transition: background 0.2s, transform 0.2s;
    }
    .modal-content button:hover {
      background: linear-gradient(90deg,#095bb5 60%,#0d78f2 100%);
      transform: scale(1.04);
    }
    .close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
      transition: color 0.2s;
      user-select: none;
    }
    .close:hover { color: #0d78f2; }
  </style>
</head>
<body>
  <div style="position:fixed;top:24px;right:32px;z-index:10001;">
    <select id="languageSelect" style="padding:0.5rem 1.2rem;border-radius:0.7rem;font-weight:600;background:#0d78f2;color:#fff;border:none;box-shadow:0 2px 8px rgba(13,120,242,0.10);font-size:1rem;">
      <option value="en">English</option>
      <option value="es">Español</option>
    </select>
  </div>
  <div class="welcome-container">
    <div class="welcome-card">
      <div class="welcome-title" id="welcomeTitle">Welcome to FocusPath!</div>
      <div class="welcome-desc" id="welcomeDesc">Where Studying Shouldn't Break the Bank.<br>Organize, learn, and achieve your goals for free.<br><span style="font-size:1.1rem;color:#0d78f2;font-weight:600;">Your journey starts here.</span></div>
      <div class="welcome-btn-group" style="display:flex;flex-direction:column;gap:1rem;align-items:center;animation:fadeIn 2.2s 1.2s both;">
        <a href="signup.html" class="welcome-btn" id="newUserBtn">New User</a>
        <button id="resetAppBtn" style="background:transparent;color:#60748a;border:none;font-size:0.9rem;text-decoration:underline;cursor:pointer;padding:0.25rem 0;">Reset App</button>
      </div>
    </div>
    <!-- Animated bubbles -->
    <div class="bubble" style="width:120px;height:120px;left:8vw;top:18vh;background:#0d78f2;animation-delay:0s;"></div>
    <div class="bubble" style="width:80px;height:80px;left:70vw;top:10vh;background:#4f8cff;animation-delay:2s;"></div>
    <div class="bubble" style="width:100px;height:100px;left:50vw;top:70vh;background:#a5b4fc;animation-delay:4s;"></div>
    <div class="bubble" style="width:60px;height:60px;left:20vw;top:80vh;background:#0d78f2;animation-delay:6s;"></div>
    <div class="bubble" style="width:90px;height:90px;left:80vw;top:60vh;background:#4f8cff;animation-delay:8s;"></div>
  </div>
  <div class="footer">© FocusPath 2025. 4a4152564953 Applications EST. 2025</div>

  <!-- Signup Modal -->
  <div id="signupModal" class="modal">
    <div class="modal-content" id="signupModalContent" style="position:relative;">
      <span class="close" onclick="closeSignupModal()" style="position:absolute;top:1rem;right:1rem;">&times;</span>
      <h3>Create Account</h3>
      <form id="signupForm" style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
        <input id="signupName" type="text" placeholder="Name" required style="width:90%;padding:0.7rem;">
        <input id="signupUsername" type="text" placeholder="Username" required style="width:90%;padding:0.7rem;">
        <input id="signupPassword" type="password" placeholder="Password" required style="width:90%;padding:0.7rem;">
        <button type="submit" style="width:100%;padding:0.9rem 0;background:#0d78f2;color:#fff;font-weight:600;border:none;border-radius:0.5rem;font-size:1.1rem;">Sign Up</button>
      </form>
    </div>
  </div>

  

  <script>
    // Language switching
    const languageData = {
      en: {
        title: "Welcome to FocusPath!",
        desc: "Where Studying Shouldn't Break the Bank.<br>Organize, learn, and achieve your goals for free.<br><span style='font-size:1.1rem;color:#0d78f2;font-weight:600;'>Your journey starts here.</span>",
        newUser: "New User",
  login: "Login",
        signup: {
          name: "Name",
          username: "Username",
          password: "Password",
          button: "Sign Up",
          title: "Create Account"
        },
        
      },
      es: {
        title: "¡Bienvenido a FocusPath!",
        desc: "Donde estudiar no debería costar una fortuna.<br>Organiza, aprende y alcanza tus metas gratis.<br><span style='font-size:1.1rem;color:#0d78f2;font-weight:600;'>Tu viaje comienza aquí.</span>",
        newUser: "Nuevo Usuario",
  login: "Iniciar Sesión",
        signup: {
          name: "Nombre",
          username: "Usuario",
          password: "Contraseña",
          button: "Registrarse",
          title: "Crear Cuenta"
        },
        
      }
    };
    document.addEventListener('DOMContentLoaded', function() {
      var langSelect = document.getElementById('languageSelect');
      var welcomeTitle = document.getElementById('welcomeTitle');
      var welcomeDesc = document.getElementById('welcomeDesc');
      var newUserBtn = document.getElementById('newUserBtn');
  var loginBtn = null;
      // Load language from localStorage
      var lang = localStorage.getItem('fpLang') || 'en';
      langSelect.value = lang;
      welcomeTitle.innerHTML = languageData[lang].title;
      welcomeDesc.innerHTML = languageData[lang].desc;
      newUserBtn.textContent = languageData[lang].newUser;
      
      function updateInputs(lang) {
        // Signup modal
        var signupTitle = document.querySelector('#signupModalContent h3');
        if(signupTitle) signupTitle.textContent = languageData[lang].signup.title;
        var signupName = document.getElementById('signupName');
        if(signupName) signupName.placeholder = languageData[lang].signup.name;
        var signupUsername = document.getElementById('signupUsername');
        if(signupUsername) signupUsername.placeholder = languageData[lang].signup.username;
        var signupPassword = document.getElementById('signupPassword');
        if(signupPassword) signupPassword.placeholder = languageData[lang].signup.password;
        var signupBtn = document.querySelector('#signupForm button[type="submit"]');
        if(signupBtn) signupBtn.textContent = languageData[lang].signup.button;
        // Login modal
        var loginTitle = document.querySelector('#loginModalContent h3');
        if(loginTitle) loginTitle.textContent = languageData[lang].loginModal.title;
        var loginUsername = document.getElementById('loginUsername');
        if(loginUsername) loginUsername.placeholder = languageData[lang].loginModal.username;
        var loginPassword = document.getElementById('loginPassword');
        if(loginPassword) loginPassword.placeholder = languageData[lang].loginModal.password;
        var loginRemember = document.getElementById('loginRemember');
        if(loginRemember && loginRemember.nextSibling) loginRemember.nextSibling.textContent = languageData[lang].loginModal.remember;
        var loginBtnModal = document.querySelector('#loginForm button[type="submit"]');
        if(loginBtnModal) loginBtnModal.textContent = languageData[lang].loginModal.button;
      }
      updateInputs(lang);
      // If an account already exists (single-user model), change New User to Continue and hide Login
      try {
        const existing = localStorage.getItem('fpTestUser');
        const dev = (localStorage.getItem('fpDevMode') === '1');
        if (existing || dev) {
          newUserBtn.textContent = (lang === 'es') ? 'Continuar' : 'Continue';
          newUserBtn.addEventListener('click', function(e){ e.preventDefault(); window.location.href = 'home.html'; });
          if (loginBtn) loginBtn.style.display = 'none';
        }
      } catch {}
      langSelect.addEventListener('change', function() {
        var lang = langSelect.value;
        localStorage.setItem('fpLang', lang);
        welcomeTitle.innerHTML = languageData[lang].title;
        welcomeDesc.innerHTML = languageData[lang].desc;
        newUserBtn.textContent = languageData[lang].newUser;
        if (loginBtn) loginBtn.textContent = languageData[lang].login;
        updateInputs(lang);
        try {
          const existing = localStorage.getItem('fpTestUser');
          const dev = (localStorage.getItem('fpDevMode') === '1');
          if (existing || dev) {
            newUserBtn.textContent = (lang === 'es') ? 'Continuar' : 'Continue';
            if (loginBtn) loginBtn.style.display = 'none';
          } else {
            if (loginBtn) loginBtn.style.display = '';
          }
        } catch {}
      });
    });
    // System theme detection
    function applySystemTheme() {
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.body.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
    }
    applySystemTheme();
    if(window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applySystemTheme);
    }
    // Fade out transition on New User/Login
    document.addEventListener('DOMContentLoaded', function() {
      document.body.style.opacity = '1';
      document.body.style.transition = 'opacity 0.7s cubic-bezier(.23,1.01,.32,1)';
      var newUserBtn = document.getElementById('newUserBtn');
      var loginBtn = document.getElementById('loginBtn');
      function fadeTo(url) {
        document.body.style.opacity = '0';
        setTimeout(function() {
          window.location.href = url;
        }, 700);
      }
      if(newUserBtn) {
        // Only open signup when there is no existing account
        let hasUser = false; let dev = false;
        try { hasUser = !!localStorage.getItem('fpTestUser'); dev = (localStorage.getItem('fpDevMode') === '1'); } catch {}
        if(!hasUser && !dev){
          newUserBtn.addEventListener('click', function(e) {
            e.preventDefault();
            openSignupModal();
          });
        }
      }
      
      // Signup form submit
      var signupForm = document.getElementById('signupForm');
      if(signupForm) {
        signupForm.addEventListener('submit', function(e) {
          e.preventDefault();
          signup();
        });
      }
      // Login form submit
      
    });
    // Index-only Developer Mode arming (Ctrl+Shift+D => "Dev Login")
    (function(){
      function computeNormalLabel(){
        const lang = (function(){ try { return localStorage.getItem('fpLang') || 'en'; } catch { return 'en'; } })();
        const hasUser = (function(){ try { return !!localStorage.getItem('fpTestUser'); } catch { return false; } })();
        if(hasUser) return (lang === 'es') ? 'Continuar' : 'Continue';
        return (lang === 'es') ? 'Nuevo Usuario' : 'New User';
      }
      function tryEnableDevWithPrompt(){
        const DEFAULT = 'focusdev';
        const code = prompt('Enter developer code');
        if(code==null) return false;
        let ok=false;
        try {
          const stored = localStorage.getItem('fpDevCode');
          ok = (code && stored && code===stored) || (!stored && code===DEFAULT);
        } catch { ok = (code===DEFAULT); }
        if(ok){
          try { localStorage.setItem('fpDevMode', '1'); } catch {}
          alert('Developer Mode enabled');
          return true;
        } else {
          alert('Invalid developer code');
          return false;
        }
      }
      document.addEventListener('DOMContentLoaded', function(){
        const btn = document.getElementById('newUserBtn');
        if(!btn) return;
        let armed = false;
        let devClick;
        function arm(){
          if(armed) return;
          armed = true;
          btn.dataset.originalLabel = btn.textContent;
          btn.textContent = 'Dev Login';
          devClick = function(e){
            e.preventDefault();
            e.stopImmediatePropagation();
            const enabled = tryEnableDevWithPrompt();
            // restore normal label regardless of success
            btn.textContent = computeNormalLabel();
            if(enabled){
              // go straight in when Dev is enabled
              window.location.href = 'home.html';
              return;
            }
            if(devClick){ btn.removeEventListener('click', devClick, true); }
            armed = false;
          };
          // capture to intercept before existing listeners
          btn.addEventListener('click', devClick, true);
        }
        function disarm(){
          if(!armed) return;
          if(devClick){ btn.removeEventListener('click', devClick, true); }
          btn.textContent = computeNormalLabel();
          armed = false;
        }
        // If language changes while armed, disarm to keep things consistent
        const langSel = document.getElementById('languageSelect');
        if(langSel){ langSel.addEventListener('change', disarm); }
        window.addEventListener('keydown', function(e){
          if(e.ctrlKey && e.shiftKey && (e.key === 'D' || e.key === 'd')){
            e.preventDefault();
            if(armed) disarm(); else arm();
          }
        });
      });
    })();
    // Modal logic
    window.openSignupModal = function() {
      document.getElementById("signupModal").style.display = "flex";
    };
    window.closeSignupModal = function() {
      document.getElementById("signupModal").style.display = "none";
    };
    
    // Reset App: clear all user-created data and settings relevant to content
    function clearUserData(){
      const KEYS = [
        'fpTestUser','fpLoginUsername','fpLoginRemember','fpCurrentUsername',
        'tests','testAttempts','flashcardSets','flashcardSessions',
        'fpDictionaryTerms','fpDictionaryLists','fpDictionaryStats',
        'fpSubjectColors','fpCustomSubjects','fpRemovedDefaultSubjects',
        'fpPersistedBadges','fpNotifiedBadges','fpFocusMasterUnlocked',
        'bookSnakeHigh','fpConceptTyperStats','fpEvents',
        'fpSoftResetTests','fpSoftResetTestsTs','fpSoftResetFlash','fpSoftResetFlashTs'
      ];
      try { KEYS.forEach(k => localStorage.removeItem(k)); } catch {}
    }
    window.resetApp = function(){
      if(confirm('This will erase all locally saved data (tests, flashcards, dictionary, stats). Continue?')){
        clearUserData();
        alert('App reset. You can create a new local account now.');
        location.reload();
      }
    };
    window.signup = async function() {
      const name = document.getElementById("signupName").value.trim();
      const username = document.getElementById("signupUsername").value.trim();
      const password = document.getElementById("signupPassword").value;
      if(!name || !username || !password) {
        alert("Please fill out all fields.");
        return;
      }
      // Single-user: prevent creating a second account on this device
      try {
        if(localStorage.getItem('fpTestUser')){
          alert('An account already exists on this device. Use "Reset App" to start fresh.');
          return;
        }
      } catch {}
      // Store user info in localStorage for testing
      const user = { name, username, password };
      localStorage.setItem('fpTestUser', JSON.stringify(user));
      alert(`Signed up as ${name} (Username: ${username})`);
      closeSignupModal();
      setTimeout(function(){ window.location.href = 'home.html'; }, 500);
    };
    
    // Autofill remembered login
    document.addEventListener('DOMContentLoaded', function() {
      // Wire up Reset App link
      var resetBtn = document.getElementById('resetAppBtn');
      if(resetBtn){ resetBtn.addEventListener('click', function(e){ e.preventDefault(); window.resetApp(); }); }
    });
  </script>
</body>
</html>
